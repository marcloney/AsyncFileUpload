!function(){function a(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var b,c,d={};b=this,null!=b&&(c=b.async),d.noConflict=function(){return b.async=c,d};var e=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},f=function(a,b){if(a.map)return a.map(b);var c=[];return e(a,function(a,d,e){c.push(b(a,d,e))}),c},g=function(a,b,c){return a.reduce?a.reduce(b,c):(e(a,function(a,d,e){c=b(c,a,d,e)}),c)},h=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};d.nextTick="undefined"!=typeof process&&process.nextTick?process.nextTick:"function"==typeof setImmediate?function(a){setImmediate(a)}:function(a){setTimeout(a,0)},d.each=function(b,c,d){if(d=d||function(){},!b.length)return d();var f=0;e(b,function(e){c(e,a(function(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d(null))}))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var e=0,f=function(){var g=!0;b(a[e],function(b){b?(c(b),c=function(){}):(e+=1,e>=a.length?c(null):g?d.nextTick(f):f())}),g=!1};f()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=i(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var i=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},j=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},k=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[i(a)].concat(c))}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},m=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};d.map=j(m),d.mapSeries=l(m),d.mapLimit=function(a,b,c,d){return n(b)(a,c,d)};var n=function(a){return k(a,m)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var g=f(a,function(a){return a}).reverse();d.reduce(g,b,c,e)},d.foldr=d.reduceRight;var o=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(f(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=j(o),d.filterSeries=l(o),d.select=d.filter,d.selectSeries=d.filterSeries;var p=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(f(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=j(p),d.rejectSeries=l(p);var q=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};d.detect=j(q),d.detectSeries=l(q),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,f(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=h(a);if(!c.length)return b(null);var f={},i=[],j=function(a){i.unshift(a)},k=function(a){for(var b=0;b<i.length;b+=1)if(i[b]===a)return i.splice(b,1),void 0},l=function(){e(i.slice(0),function(a){a()})};j(function(){h(f).length===c.length&&(b(null,f),b=function(){})}),e(c,function(c){var e=a[c]instanceof Function?[a[c]]:a[c],h=function(a){if(a)b(a),b=function(){};else{var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),f[c]=e,d.nextTick(l)}},i=e.slice(0,Math.abs(e.length-1))||[],m=function(){return g(i,function(a,b){return a&&f.hasOwnProperty(b)},!0)&&!f.hasOwnProperty(c)};if(m())e[e.length-1](h,f);else{var n=function(){m()&&(k(n),e[e.length-1](h,f))};j(n)}})},d.waterfall=function(a,b){if(b=b||function(){},!a.length)return b();var c=function(a){return function(e){if(e)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(c(g)):f.push(b),d.nextTick(function(){a.apply(null,f)})}}};c(d.iterator(a))()};var r=function(a,b,c){if(c=c||function(){},b.constructor===Array)a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(h(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){r({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){r({map:n(b),each:i(b)},a,c)},d.series=function(a,b){if(b=b||function(){},a.constructor===Array)d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(h(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var s=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=j(s),d.concatSeries=l(s),d.whilst=function(a,b,c){if(a()){var e=!0;b(function(f){return f?c(f):(e?d.nextTick(function(){d.whilst(a,b,c)}):d.whilst(a,b,c),void 0)}),e=!1}else c()},d.doWhilst=function(a,b,c){var e=!0;a(function(f){return f?c(f):(b()?e?d.nextTick(function(){d.doWhilst(a,b,c)}):d.doWhilst(a,b,c):c(),void 0)}),e=!1},d.until=function(a,b,c){if(a())c();else{var e=!0;b(function(f){return f?c(f):(e?d.nextTick(function(){d.until(a,b,c)}):d.until(a,b,c),void 0)}),e=!1}},d.doUntil=function(a,b,c){var e=!0;a(function(f){return f?c(f):(b()?c():e?d.nextTick(function(){d.doUntil(a,b,c)}):d.doUntil(a,b,c),void 0)}),e=!1},d.queue=function(b,c){function f(a,b,f,g){b.constructor!==Array&&(b=[b]),e(b,function(b){var e={data:b,callback:"function"==typeof g?g:null};f?a.tasks.unshift(e):a.tasks.push(e),a.saturated&&a.tasks.length===c&&a.saturated(),d.nextTick(a.process)})}var g=0,h={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,push:function(a,b){f(h,a,!1,b)},unshift:function(a,b){f(h,a,!0,b)},process:function(){if(g<h.concurrency&&h.tasks.length){var c=h.tasks.shift();h.empty&&0===h.tasks.length&&h.empty(),g+=1;var e=!0,f=function(){g-=1,c.callback&&c.callback.apply(c,arguments),h.drain&&0===h.tasks.length+g&&h.drain(),h.process()},i=a(function(){var a=arguments;e?d.nextTick(function(){f.apply(null,a)}):f.apply(null,arguments)});b(c.data,i),e=!1}},length:function(){return h.tasks.length},running:function(){return g}};return h},d.cargo=function(a,b){var c=!1,g=[],h={tasks:g,payload:b,saturated:null,empty:null,drain:null,push:function(a,c){a.constructor!==Array&&(a=[a]),e(a,function(a){g.push({data:a,callback:"function"==typeof c?c:null}),h.saturated&&g.length===b&&h.saturated()}),d.nextTick(h.process)},process:function i(){if(!c){if(0===g.length)return h.drain&&h.drain(),void 0;var d="number"==typeof b?g.splice(0,b):g.splice(0),j=f(d,function(a){return a.data});h.empty&&h.empty(),c=!0,a(j,function(){c=!1;var a=arguments;e(d,function(b){b.callback&&b.callback.apply(null,a)}),i()})}},length:function(){return g.length},running:function(){return c}};return h};var t=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&e(c,function(b){console[a](b)}))}]))}};d.log=t("log"),d.dir=t("dir"),d.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;a>f;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;a>f;f++)e.push(f);return d.mapSeries(e,b,c)},d.compose=function(){var a=Array.prototype.reverse.call(arguments);return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},"undefined"!=typeof define&&define.amd?define([],function(){return d}):"undefined"!=typeof module&&module.exports?module.exports=d:b.async=d}(),function(a){"use strict";var b={dragText:"Drop file(s) here"},c=function(b,c){var d=this;this.format_bytes=function(a,b){var c=1024,d=1024*c,e=1024*d,f=1024*e;return a>=0&&c>a?a+" B":a>=c&&d>a?(a/c).toFixed(b)+" KB":a>=d&&e>a?(a/d).toFixed(b)+" MB":a>=e&&f>a?(a/e).toFixed(b)+" GB":a>=f?(a/f).toFixed(b)+" TB":a+" B"},this.render=function(){var b=a("<tr>").attr("id",window.btoa(this.file.name)),c=this.format_bytes(this.file.size,2),e=["pdf","image","word","zip","video","audio"],f="other";return async.each(e,function(a){d.file.type.indexOf(a)>=0&&(f=a)}),a("<td>").addClass("afu-filetype").attr("data-filetype",f).appendTo(b),a("<td>").addClass("afu-filename").html(this.file.name).appendTo(b),a("<td>").addClass("afu-filesize").html(c).appendTo(b),this.$progress=a("<td>").addClass("afu-progress").html("0%").appendTo(b),b},this.upload=function(a){var b=new XMLHttpRequest,c=function(a){var b=parseInt(100*(a.loaded/a.total),10);d.$progress.html(b+"%")};b.upload&&(b.upload.addEventListener("progress",c,!1),b.onreadystatechange=function(){return 4==b.readyState?200==b.status?(d.$progress.html("success"),a.bind(d)):(d.$progress.html("failure"),a(b.status)):void 0},b.open("POST",this.url,!0),b.setRequestHeader("X_FILENAME",this.file.name),b.send(this.file))},this.init=function(a,b){this.file=a,this.url=b},this.init(b,c)};a.AsyncFileUpload=function(d,e){var f=this;this.init=function(b){return this.options=a.extend({},a.AsyncFileUpload.defaultOptions,e),this.$input=a(b),this.$input.data("AsyncFileUpload",this),this.$input.is("input[type=file]")?(this.$input.wrap("<div>"),this.$container=this.$input.parent().addClass("afu-container"),this.files=[],g(),h(),void 0):a.error("Cannot call on non input[type=file] DOM object.")},this.clear=function(){this.files=[],this.$log.html(""),this.$input.val("")},this.destroy=function(){a().add(this.$drag).add(this.$log).remove(),this.$input.unwrap()},this.upload=function(b){var c=[];async.each(f.files,function(a,b){a.upload(function(){c.push(this.file),b()})},function(d){return f.files=[],d?a.error(d):b(c)})};var g=function(){f.options.inputHidden&&f.$input.hide(),f.options.drag&&(f.$drag=a("<div>").addClass("afu-drag").appendTo(f.$container),a("<p>").html(b.dragText).appendTo(f.$drag)),f.options.dragHidden&&f.$drag.hide(),f.$log=a("<table>").addClass("afu-log").appendTo(f.$container)},h=function(){var b=function(a){var b=a.target.files||a.dataTransfer.files;a.stopPropagation(),a.preventDefault();for(var d=0;d<b.length;++d){var e=new c(b[d],f.options.url);f.files.push(e),f.$log.append(e.render())}f.$drag.removeClass("afu-dragover"),f.$input.val("")};f.$input.on("change",b),f.options.drag&&(new XMLHttpRequest).upload&&f.$drag.get(0).addEventListener("drop",b,!1);var d=function(b){b.stopPropagation(),b.preventDefault(),a(this).addClass("afu-dragover")};f.options.drag&&f.$drag.on("dragover",d);var e=function(b){b.stopPropagation(),b.preventDefault(),a(this).removeClass("afu-dragover")};f.options.drag&&f.$drag.on("dragleave",e)};this.init(d)},a.AsyncFileUpload.defaultOptions={inputHidden:!1,dragHidden:!1,drag:!0},a.fn.AsyncFileUpload=function(b){if(!window.File||!window.FileList||!window.FileReader)return a.error("Your browser does not support the HTML5 File API.");var c=arguments;return this.each(function(){var d=a(this).data("AsyncFileUpload");return"string"==typeof b&&d[b]?d[b].apply(this,Array.prototype.slice.call(c,1)):"object"==typeof b?new a.AsyncFileUpload(this,b):a.error("Method "+b+"does not exist.")})}}(jQuery);